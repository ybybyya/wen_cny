<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>ğŸ† éƒ‘æœ‰å½£ æ–°å¹´å¿«ä¹ ğŸ†</title>
<link href="https://fonts.googleapis.com/css2?family=ZCOOL+QingKe+HuangYou&display=swap" rel="stylesheet">
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: black;
        font-family: 'ZCOOL QingKe HuangYou', cursive;
    }
    canvas {
        display: block;
    }
    .text {
        position: absolute;
        top: 20%;
        width: 100%;
        text-align: center;
        color: gold;
        font-size: 80px;
        font-weight: bold;
        text-shadow: 0 0 20px red, 0 0 40px yellow, 0 0 60px gold;
        pointer-events: none;
        animation: glow 1.5s infinite alternate;
    }
    @keyframes glow {
        0% { text-shadow: 0 0 20px red, 0 0 40px yellow, 0 0 60px gold; }
        100% { text-shadow: 0 0 30px red, 0 0 60px yellow, 0 0 90px gold; }
    }
    .red-packet {
        position: absolute;
        width: 50px;
        height: 60px;
        background: linear-gradient(to bottom, #ff4d4d, #b20000);
        border: 2px solid gold;
        border-radius: 8px;
        color: gold;
        font-weight: bold;
        text-align: center;
        line-height: 60px;
        font-size: 20px;
        box-shadow: 0 0 15px gold;
        transform: rotate(0deg);
        pointer-events: none;
    }
</style>
</head>
<body>

<div class="text">éƒ‘æœ‰å½£ æ–°å¹´å¿«ä¹</div>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// ---------- æ˜Ÿæ˜Ÿ ----------
let stars = [];
for(let i=0;i<100;i++){
    stars.push({
        x: Math.random()*canvas.width,
        y: Math.random()*canvas.height,
        size: Math.random()*2,
        alpha: Math.random()
    });
}

// ---------- çƒŸèŠ± ----------
let fireworks = [];
function Firework(x, y, isHeart=false) {
    this.x = x;
    this.y = y;
    this.particles = [];
    const color = Math.random()*360;
    for (let i = 0; i < 80; i++) {
        let angle = Math.random() * 2 * Math.PI;
        if(isHeart){
            // çˆ±å¿ƒå½¢çŠ¶å…¬å¼ r = 1 - sinÎ¸
            angle = i / 80 * 2 * Math.PI;
        }
        this.particles.push({
            x: x,
            y: y,
            angle: angle,
            speed: isHeart ? Math.random()*2+2 : Math.random()*6+2,
            alpha: 1,
            color: color + Math.random()*60,
            isHeart: isHeart
        });
    }
    this.update = function () {
        this.particles.forEach(p => {
            if(p.isHeart){
                const t = p.angle;
                p.x = this.x + 16*Math.pow(Math.sin(t),3)*10;
                p.y = this.y - (13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t))*10;
                p.alpha -= 0.02;
            } else {
                p.x += Math.cos(p.angle) * p.speed;
                p.y += Math.sin(p.angle) * p.speed + 0.5;
                p.alpha -= 0.02;
            }
        });
    };
    this.draw = function () {
        this.particles.forEach(p => {
            ctx.globalAlpha = p.alpha;
            ctx.fillStyle = `hsl(${p.color},100%,50%)`;
            ctx.beginPath();
            ctx.arc(p.x, p.y, 3, 0, 2 * Math.PI);
            ctx.fill();
        });
        ctx.globalAlpha = 1;
    };
}

// ---------- æµæ˜Ÿ ----------
let meteors = [];
function Meteor() {
    this.x = Math.random()*canvas.width;
    this.y = Math.random()*canvas.height/2;
    this.len = Math.random()*100 + 50;
    this.speed = Math.random()*10 + 5;
    this.angle = Math.PI/4;
    this.alpha = 1;
    this.update = function () {
        this.x += Math.cos(this.angle) * this.speed;
        this.y += Math.sin(this.angle) * this.speed;
        this.alpha -= 0.01;
    }
    this.draw = function() {
        ctx.globalAlpha = this.alpha;
        ctx.strokeStyle = "white";
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(this.x, this.y);
        ctx.lineTo(this.x - this.len*Math.cos(this.angle), this.y - this.len*Math.sin(this.angle));
        ctx.stroke();
        ctx.globalAlpha = 1;
    }
}

// ---------- çº¢åŒ… ----------
let redPackets = [];
function RedPacket() {
    this.el = document.createElement('div');
    this.el.className = 'red-packet';
    this.el.innerText = 'ç¦';
    document.body.appendChild(this.el);
    this.x = Math.random()*window.innerWidth;
    this.y = -60;
    this.speedY = Math.random()*2 + 1;
    this.speedX = Math.random()*1 - 0.5;
    this.angle = 0;
    this.rotateSpeed = (Math.random()*2-1)*2;
    this.update = () => {
        this.y += this.speedY;
        this.x += this.speedX;
        this.angle += this.rotateSpeed;
        this.el.style.top = this.y + 'px';
        this.el.style.left = this.x + 'px';
        this.el.style.transform = `rotate(${this.angle}deg)`;
        if(this.y > window.innerHeight){
            document.body.removeChild(this.el);
            redPackets.splice(redPackets.indexOf(this),1);
        }
    }
    redPackets.push(this);
}

// ---------- åŠ¨ç”» ----------
function animate(){
    ctx.fillStyle = "rgba(0,0,0,0.2)";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    stars.forEach(s=>{
        ctx.globalAlpha = s.alpha;
        ctx.fillStyle = "white";
        ctx.beginPath();
        ctx.arc(s.x,s.y,s.size,0,2*Math.PI);
        ctx.fill();
        ctx.globalAlpha = 1;
    });

    fireworks.forEach((f,i)=>{
        f.update();
        f.draw();
        if(f.particles[0].alpha <=0) fireworks.splice(i,1);
    });

    meteors.forEach((m,i)=>{
        m.update();
        m.draw();
        if(m.alpha <=0) meteors.splice(i,1);
    });

    redPackets.forEach(r => r.update());

    requestAnimationFrame(animate);
}

// ---------- è‡ªåŠ¨ç”Ÿæˆ ----------
setInterval(()=>fireworks.push(new Firework(Math.random()*canvas.width, Math.random()*canvas.height/2)), 700);
setInterval(()=>fireworks.push(new Firework(Math.random()*canvas.width, Math.random()*canvas.height/2, true)), 3000); // çˆ±å¿ƒçƒŸèŠ±
setInterval(()=>meteors.push(new Meteor()), 1500);
setInterval(()=>new RedPacket(), 800);

// ---------- ç‚¹å‡»ç”ŸæˆçƒŸèŠ± ----------
canvas.addEventListener('click', e=>{
    fireworks.push(new Firework(e.clientX, e.clientY));
});

// ---------- é¡µé¢éœ‡åŠ¨ ----------
window.onload = function(){
    if(navigator.vibrate) navigator.vibrate([100,50,100]);
};

animate();
</script>

</body>
</html>
